<!-- HTML header for doxygen 1.8.9-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/x-icon"/>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLUtils: CLUtils Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="css/font-awesome.min.css" rel="stylesheet">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57722192-1', 'auto');
  ga('send', 'pageview');
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="width: 100%;">
 <tbody>
 <tr style="height: 72px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLUtils
   &#160;<span id="projectnumber">0.2.1</span>
   </div>
  </td>
  <td><a id="repo" href="https://github.com/nlamprian/CLUtils"><i class="fa fa-github"></i><span id="repo-text">&nbsp;Hosted by GitHub</span></a></td>
  <td id="projectlogo"><a href="https://nlamprian.me"><img alt="Logo" src="logo.png"/></a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CLUtils Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>CLUtils </h1>
<hr/>
<p>CLUtils offers utilities that help setup and manage an OpenCL environment. It aims to allow rapid prototyping by hiding away all the boilerplate code necessary for establishing an OpenCL environment.</p>
<p>This meant to be an exercise on how I would go about containing the OpenCL entities, and developing an API to interface them all. But since I didn't have a solid idea of what I needed, I started writing the code and ended up adapting the API around it. The result was an API that made use of indices to refer to OpenCL objects which only makes it efficient to use under a known environment. Nonetheless, the library works pretty robustly.</p>
<p>If you would like something more general and complete, take a look at <a href="https://github.com/kylelutz/compute">boost.compute</a> or <a href="http://developer.amd.com/tools-and-sdks/opencl-zone/amd-accelerated-parallel-processing-app-sdk/">AMD APP SDK's CLUtil</a>.</p>
<p><b>Utilities</b> offered by the library involve procedures like <b>compiling source files</b>, sharing <b>OpenCL environment configurations</b>, setting up <b>OpenCL-OpenGL interoperability</b>, <b>profiling</b> <b>host</b> and <b>device</b> code, and getting <b>summarizing results</b> on <b>profiling data</b>.</p>
<p><b>New on version 0.2:</b></p>
<ul>
<li>
Updated <b>CLEnv</b> API to support command queue profiling </li>
<li>
Added support in <b>CLEnv</b> for OpenCL-OpenGL interoperability </li>
<li>
Added <b>CLEnvInfo</b> to support conveyance of OpenCL env configurations </li>
<li>
Added <b>CPUTimer</b> for profiling host code </li>
<li>
Added <b>GPUTimer</b> for profiling device code </li>
<li>
Added <b>ProfilingInfo</b> for manipulating profiling data </li>
</ul>
<h1>API </h1>
<hr/>
<div class="image">
<img src="https://img.shields.io/badge/API-experimental-red.svg?style=flat"  alt="api" align="left"/>
</div>
<p><br />
<br />
 The simplest case handled by the library is one where a context is created for the first platform returned by the OpenCL API and a command queue is created for the first device in that platform. Programs are built for all devices in the associated context. This case is realized automatically when a <b>kernel filename</b> is provided on the definition of a <code>CLEnv</code> <b>instance</b>. Omitting the <b>kernel filename</b> in the <b>CLEnv constructor</b> allows to later specify exactly the <b>OpenCL environment configuration</b> to set up.</p>
<blockquote class="doxtable">
<p>#include &lt;<a class="el" href="CLUtils_8hpp.html" title="Declarations of objects, functions and classes for the CLUtils library. ">CLUtils.hpp</a>&gt;</p>
<p>using namespace clutils;</p>
<p>int main () <br />
 { <br />
 &#160;&#160;&#160;&#160; CLEnv clEnv ("myKernels.cl"); <br />
 &#160;&#160;&#160;&#160; cl::Context &amp;context (clEnv.getContext ()); <br />
 &#160;&#160;&#160;&#160; cl::CommandQueue &amp;queue (clEnv.getQueue ()); <br />
 &#160;&#160;&#160;&#160; cl::Kernel &amp;kernel (clEnv.getKernel ("myKernel")); <br />
 &#160;&#160;&#160;&#160; cl::NDRange global (1024), local (256); <br />
</p>
<p>&#160;&#160;&#160;&#160; cl::Buffer dBuf (context, CL_MEM_READ_WRITE, 1024 * sizeof (int)); <br />
 &#160;&#160;&#160;&#160; kernel.setArg (0, dBuf);</p>
<p>&#160;&#160;&#160;&#160; queue.enqueueNDRangeKernel (kernel, cl::NullRange, global, local);</p>
<p>&#160;&#160;&#160;&#160; return 0; <br />
 } </p>
</blockquote>
<p><br />
 <b>Profiling</b> is enabled with the use of the <code>GPUTimer</code> and <code>ProfilingInfo</code> classes. <b>GPUTimer</b> does the actual timekeeping, and <b>ProfilingInfo</b> offers summarizing results on the profiling data.</p>
<blockquote class="doxtable">
<p>#include &lt;<a class="el" href="CLUtils_8hpp.html" title="Declarations of objects, functions and classes for the CLUtils library. ">CLUtils.hpp</a>&gt; <br />
</p>
<p>using namespace clutils; <br />
</p>
<p>int main () <br />
 { <br />
 &#160;&#160;&#160;&#160; CLEnv clEnv; <br />
 &#160;&#160;&#160;&#160; cl::Context &amp;context (clEnv.addContext (0)); <br />
 &#160;&#160;&#160;&#160; cl::CommandQueue &amp;queue (clEnv.addQueue (0, 0, CL_QUEUE_PROFILING_ENABLE)); <br />
 &#160;&#160;&#160;&#160; cl::Kernel &amp;kernel (clEnv.addProgram (0, "myKernels.cl", "myKernel")); <br />
 &#160;&#160;&#160;&#160; cl::NDRange global (1024), local (256); <br />
</p>
<p>&#160;&#160;&#160;&#160; cl::Buffer dBuf (context, CL_MEM_READ_WRITE, 1024 * sizeof (int)); <br />
 &#160;&#160;&#160;&#160; kernel.setArg (0, dBuf); <br />
</p>
<p>&#160;&#160;&#160;&#160; GPUTimer&lt;std::milli&gt; gTimer (clEnv.devices[0][0]); <br />
 &#160;&#160;&#160;&#160; ProfilingInfo&lt;10&gt; pGPU ("GPU"); <br />
</p>
<p>&#160;&#160;&#160;&#160; for (int i = 0; i &lt; 10; ++i) <br />
 &#160;&#160;&#160;&#160; { <br />
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; queue.enqueueNDRangeKernel (kernel, cl::NullRange, global, local, nullptr, &amp;gTimer.event ()); <br />
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; gTimer.wait (); <br />
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pGPU[i] = gTimer.duration (); <br />
 &#160;&#160;&#160;&#160; } <br />
</p>
<p>&#160;&#160;&#160;&#160; pGPU.print ("myKernel"); <br />
</p>
<p>&#160;&#160;&#160;&#160; return 0; <br />
 } </p>
</blockquote>
<p><br />
 Having defined all the necessary <b>OpenCL entities</b> in <b>CLEnv</b>, an <b>OpenCL configuration</b> can now be specified with <code>CLEnvInfo</code> and communicated to a class that manages and executes some kind of algorithm.</p>
<blockquote class="doxtable">
<p>#include &lt;<a class="el" href="CLUtils_8hpp.html" title="Declarations of objects, functions and classes for the CLUtils library. ">CLUtils.hpp</a>&gt; <br />
</p>
<p>using namespace clutils; <br />
</p>
<p>class PrefixSum; <br />
</p>
<p>int main () <br />
 { <br />
 &#160;&#160;&#160;&#160; CLEnv clEnv ("myKernels.cl"); <br />
 &#160;&#160;&#160;&#160; cl::Context &amp;context (clEnv.getContext ()); <br />
 &#160;&#160;&#160;&#160; cl::CommandQueue &amp;queue (clEnv.getQueue ()); <br />
</p>
<p>&#160;&#160;&#160;&#160; CLEnvInfo&lt;1&gt; info (0, 0, 0, { 0 }, 0); <br />
 &#160;&#160;&#160;&#160; PrefixSum scan (clEnv, info); <br />
</p>
<p>&#160;&#160;&#160;&#160; scan.run (); <br />
</p>
<p>&#160;&#160;&#160;&#160; return 0; <br />
 } </p>
</blockquote>
<p><br />
 </p><h1>Build &amp; Install </h1>
<hr/>
<blockquote class="doxtable">
<p>git clone <a href="https://github.com/nlamprian/CLUtils.git">https://github.com/nlamprian/CLUtils.git</a> <br />
 cd CLUtils</p>
<p>mkdir build <br />
 cd build</p>
<p>cmake -DBUILD_EXAMPLES=ON .. <br />
 # or to build the tests too <br />
 cmake -DBUILD_EXAMPLES=ON -DBUILD_TESTS=ON ..</p>
<p>make</p>
<p># to run the example (from the build directory!) <br />
 ./bin/clutils_vecAdd</p>
<p># to run the tests <br />
 ./bin/clutils_tests</p>
<p># to install the library <br />
 sudo make install</p>
<p># to build the docs <br />
 make doxygen <br />
 firefox docs/html/index.html</p>
</blockquote>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 11 2015 02:21:13 for CLUtils by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
